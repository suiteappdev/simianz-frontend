//region Imports
import globby from 'globby'
import _ from 'lodash'
//endregion

class PluginLocator {

  constructor(opts = {}) {

    this.opts = _.defaults(opts, {
      exts: ['json', 'cson', 'js'],
      folders: ['node_modules', 'modules'],
      //files: ['live.browser', 'live.shared', 'live'],
      files: ['live.shared', 'live'],
      rootDir: process.cwd(),
    })
  }

  getGlob() {
    const files = this.opts.files.join('|')
    const dirs = this.opts.folders.join('|')
    const exts = this.opts.exts.join('|')
    return this.opts.rootDir + `/@(${dirs})/*/@(${files}).@(${exts})`
  }

  locate() {
    console.log(this.getGlob())
    const paths = globby.sync(this.getGlob())
    return paths
  }

}

const main = (opts) => new PluginLocator(opts).locate()

main.PluginLocator = PluginLocator

module.exports = main
